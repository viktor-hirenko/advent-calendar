# Troubleshooting — вирішення поширених проблем

Цей документ містить рішення найпоширеніших проблем, з якими можуть зіткнутися розробники та контент-менеджери при роботі з Advent Calendar Hub.

## Зміст
- [Проблеми з сіткою календаря](#проблеми-з-сіткою-календаря)
- [Проблеми з плейсхолдерами](#проблеми-з-плейсхолдерами)
- [Проблеми з локалізацією](#проблеми-з-локалізацією)
- [Проблеми з таймерами](#проблеми-з-таймерами)
- [Проблеми з модальним вікном](#проблеми-з-модальним-вікном)
- [Проблеми зі збіркою](#проблеми-зі-збіркою)
- [Проблеми з продуктивністю](#проблеми-з-продуктивністю)

---

## Проблеми з сіткою календаря

### Дні не вирівнюються по днях тижня на десктопі

**Симптоми:**
- Дні відображаються послідовно без вирівнювання по колонках
- Плейсхолдери не з'являються на початку місяця

**Причини та рішення:**

1. **Перевірте конфігурацію:**
   ```json
   {
     "config": {
       "alignByWeekday": true  // Має бути true
     }
   }
   ```

2. **Перевірте ширину екрану:**
   - Вирівнювання працює тільки на екранах `>= 768px`
   - Відкрийте DevTools → перевірте ширину viewport
   - Переконайтеся, що `useMediaQuery('(min-width: 768px)')` повертає `true`

3. **Перевірте в консолі:**
   ```javascript
   // Відкрийте DevTools Console і виконайте:
   window.matchMedia('(min-width: 768px)').matches
   // Має повернути true на десктопі
   ```

4. **Перевірте CSS:**
   - Переконайтеся, що немає CSS правил, які перекривають grid layout
   - Перевірте, що `.calendar-days__container` має `display: grid`

### Сітка ламається на певних екранах

**Симптоми:**
- Дні накладаються один на одного
- Неправильна кількість колонок

**Рішення:**

1. **Перевірте брейкпоінти:**
   ```scss
   // src/assets/scss/tokens/_breakpoints.scss
   $breakpoints: (
     sm: 375px,
     md: 600px,
     lg: 768px,    // Критичний для alignByWeekday
     xl: 1024px,
     xxl: 1280px,
     xxxl: 1440px,
     fhd: 1920px,
     ultra: 2880px
   );
   ```

2. **Перевірте CSS Grid:**
   ```scss
   .calendar-days__container {
     display: grid;
     grid-template-columns: repeat(7, 1fr); // 7 колонок для тижня
   }
   ```

3. **Очистіть кеш браузера:**
   - Ctrl+Shift+R (Windows/Linux)
   - Cmd+Shift+R (macOS)

---

## Проблеми з плейсхолдерами

### Плейсхолдери не відображаються

**Симптоми:**
- Місяць починається з першого дня без відступів
- Дні не вирівняні по днях тижня

**Діагностика:**

1. **Перевірте DOM:**
   ```javascript
   // DevTools Console:
   document.querySelectorAll('.calendar-days__placeholder')
   // Має повернути NodeList з плейсхолдерами
   ```

2. **Перевірте атрибути:**
   ```html
   <div class="calendar-days__placeholder" aria-hidden="true"></div>
   ```

3. **Перевірте CSS:**
   ```scss
   .calendar-days__placeholder {
     opacity: 0;              // Невидимі
     pointer-events: none;    // Не інтерактивні
     // НЕ ПОВИННО БУТИ: display: none;
   }
   ```

**Рішення:**

1. **Видаліть `display: none` з плейсхолдерів:**
   - Плейсхолдери мають бути в DOM, але невидимими
   - Використовуйте `opacity: 0` замість `display: none`

2. **Перевірте медіа-запити:**
   ```scss
   // НЕПРАВИЛЬНО:
   @include mq(lg, 'down') {
     .calendar-days__placeholder {
       display: none; // Це ламає сітку!
     }
   }
   
   // ПРАВИЛЬНО:
   // Плейсхолдери завжди в DOM, просто невидимі
   ```

### Плейсхолдери видимі на екрані

**Симптоми:**
- Порожні клітинки на початку місяця
- Плейсхолдери мають фон або рамку

**Рішення:**

1. **Перевірте opacity:**
   ```scss
   .calendar-days__placeholder {
     opacity: 0; // Має бути 0
   }
   ```

2. **Перевірте CSS специфічність:**
   - Можливо, інші правила перекривають `opacity: 0`
   - Використайте DevTools → Inspect → Computed для перевірки

---

## Проблеми з локалізацією

### Тексти відображаються англійською замість обраної мови

**Причини:**

1. **Відсутній переклад:**
   ```json
   {
     "calendar": {
       "title": {
         "en": "Sports Calendar",
         "de": "Sportkalender"
         // Відсутні fr, it, es, pt
       }
     }
   }
   ```

2. **Неправильна мова в query:**
   ```
   ?language=fr  // Але fr немає в supportedLanguages
   ```

**Рішення:**

1. **Додайте всі переклади:**
   ```json
   {
     "config": {
       "supportedLanguages": ["en", "de", "fr", "it", "es", "pt"]
     },
     "calendar": {
       "title": {
         "en": "Sports Calendar",
         "de": "Sportkalender",
         "fr": "Calendrier Sportif",
         "it": "Calendario Sportivo",
         "es": "Calendario Deportivo",
         "pt": "Calendário Esportivo"
       }
     }
   }
   ```

2. **Перевірте fallback:**
   - Система автоматично використовує англійську, якщо переклад відсутній
   - Це нормальна поведінка, але краще додати всі переклади

### Мова не змінюється через query-параметр

**Перевірте:**

1. **URL:**
   ```
   http://localhost:5173/?language=de
   ```

2. **Підтримувані мови:**
   ```json
   {
     "config": {
       "supportedLanguages": ["en", "de"]  // de має бути в списку
     }
   }
   ```

3. **Консоль:**
   - Перевірте, чи немає помилок у консолі
   - `useQueryParams` має розпізнати параметр

---

## Проблеми з таймерами

### Таймер не оновлюється

**Симптоми:**
- Час залишився застиг
- Таймер показує неправильний час

**Рішення:**

1. **Перевірте timeMode:**
   ```json
   {
     "config": {
       "timeMode": "local"  // або "utc"
     }
   }
   ```

2. **Перевірте дату:**
   - Переконайтеся, що системний час правильний
   - Перевірте часовий пояс браузера

3. **Перевірте консоль:**
   - Можуть бути помилки в `watchEffect` або `setInterval`

### Таймер показує від'ємні значення

**Причина:**
- День вже завершився, але статус не оновився

**Рішення:**

1. **Перевірте логіку статусів:**
   ```typescript
   // TaskCard.vue
   const isActive = computed(() => {
     return timeFns.value.isToday(taskDate.value)
   })
   ```

2. **Перезавантажте сторінку:**
   - Система має автоматично оновити статуси при переході через північ
   - Якщо ні, це баг — перевірте `watch(todayYMD, ...)` в `CalendarContent.vue`

---

## Проблеми з модальним вікном

### Модальне вікно не відкривається

**Перевірте:**

1. **Конфігурацію:**
   ```json
   {
     "config": {
       "ui": {
         "footerSection": {
           "visible": true,
           "termsButton": true,
           "termsModal": {
             "visible": true
           }
         }
       }
     }
   }
   ```

2. **Контент:**
   ```json
   {
     "calendar": {
       "termsModal": {
         "title": { "en": "Terms and Conditions" },
         "html": { "en": "<p>Terms content...</p>" }
       }
     }
   }
   ```

3. **Стан:**
   ```javascript
   // DevTools Console:
   // Перевірте, чи змінюється showTerms
   ```

### Модальне вікно не закривається

**Можливі причини:**

1. **JavaScript помилка:**
   - Перевірте консоль на помилки
   - Переконайтеся, що `emit('update:modelValue', false)` викликається

2. **Focus trap:**
   - Натисніть ESC
   - Клікніть на backdrop (темний фон)

3. **Z-index конфлікт:**
   - Перевірте, що модалка має найвищий z-index
   - `z-index: 8` за замовчуванням

### Скрол не блокується при відкритті модалки

**Рішення:**

1. **Перевірте клас:**
   ```javascript
   // DevTools Elements:
   // <body> має мати клас .scroll-lock
   ```

2. **Перевірте CSS:**
   ```scss
   .scroll-lock {
     overflow: hidden;
     touch-action: none;
   }
   ```

---

## Проблеми зі збіркою

### Помилка "Cannot find module"

**Рішення:**

1. **Видаліть node_modules:**
   ```bash
   rm -rf node_modules package-lock.json
   npm install
   ```

2. **Перевірте версію Node.js:**
   ```bash
   node --version
   # Має бути 20.19+ або 22.12+
   ```

### Помилка TypeScript

**Рішення:**

1. **Запустіть type-check:**
   ```bash
   npm run type-check
   ```

2. **Перевірте tsconfig.json:**
   - Переконайтеся, що всі шляхи правильні
   - Перевірте, що `strict: true`

### Помилка ESLint

**Рішення:**

1. **Запустіть lint:**
   ```bash
   npm run lint
   ```

2. **Автоматичне виправлення:**
   ```bash
   npm run lint -- --fix
   ```

---

## Проблеми з продуктивністю

### Повільний скрол

**Причини:**
- Занадто багато DOM-елементів
- Неоптимізовані зображення
- Відсутність RAF для скрол-хендлерів

**Рішення:**

1. **Перевірте кількість днів:**
   - Рекомендується не більше 92 днів
   - `validate-config` попереджає про це

2. **Оптимізуйте зображення:**
   ```bash
   npm run images:webp
   ```

3. **Перевірте RAF:**
   ```typescript
   // CalendarContent.vue використовує requestAnimationFrame
   // для оптимізації скрол-хендлерів
   ```

### Повільне завантаження

**Рішення:**

1. **Перевірте розмір bundle:**
   ```bash
   npm run build
   # Перевірте dist/ розміри
   ```

2. **Використайте WebP:**
   - Всі зображення мають бути в WebP форматі
   - PNG/JPG тільки як fallback

3. **Lazy loading:**
   - Зображення використовують `loading="lazy"`
   - Перевірте в DevTools → Network

---

## Додаткові ресурси

- [CONFIG_GUIDE.md](CONFIG_GUIDE.md) — детальна конфігурація
- [COMPONENTS_API.md](COMPONENTS_API.md) — API компонентів
- [DEVELOPER_GUIDE.md](DEVELOPER_GUIDE.md) — внутрішня архітектура
- [DESIGN_TOKENS.md](DESIGN_TOKENS.md) — стилізація та токени

Якщо проблема не вирішена, перевірте консоль браузера на помилки та створіть issue з детальним описом проблеми.


