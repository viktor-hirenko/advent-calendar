# Advent Calendar Hub — технічна документація

## 1. Короткий огляд

**Advent Calendar Hub** — це універсальний UI-модуль для святкових промокампаній букмекерських продуктів. Календар показує щоденні задачі/бонуси в обраному діапазоні дат, підтримує декілька мов інтерфейсу та легко брендиться завдяки конфігураційним файлам і дизайн-токенам.

### Бізнес-цілі

- швидке розгортання нових кампаній без переписування коду;
- централізоване керування контентом через `app-config.json`;
- мультибрендова та мультимовна підтримка (iframe-вбудування);
- контроль таймерів, статусів задач та "анонсованих" днів для утримання користувача;
- гнучке керування видимістю UI-секцій через `config.ui`.

## 2. Архітектура та стек

| Рівень     | Використані технології                                                        | Коментар                                                            |
| ---------- | ----------------------------------------------------------------------------- | ------------------------------------------------------------------- |
| UI         | Vue 3 (Composition API), TypeScript, SCSS                                     | Компонентна реалізація календаря та банера                          |
| Дані       | JSON (`src/data/app-config.json`)                                             | Контент, строки, конфігурація дат                                   |
| Компоненти | `CalendarBanner`, `CalendarContent`, `CalendarDays`, `TaskCard`, `TermsModal` | Відповідають за банер, сітку днів, карточки задач та модальні вікна |
| Компосабли | `useAppConfig`, `useLocale`, `useQueryParams`, `useMediaQuery`, `useTokens`   | Оркеструють конфіг, мову, адаптивність, дизайн-токени               |
| Утиліти    | `utils/dateUtils`, `utils/sanitizeHtml`, `utils/devLog`                       | Часові зони, HTML-санація, dev-логування                            |
| Сборка     | Vite, `npm-run-all2`, скрипти в `scripts/`                                    | Підготовка токенів, оптимізація зображень, валідація конфіг         |

Структура директорії:

```
src/
 ├─ components/          # UI-компоненти календаря
 ├─ composables/         # Внутрішні хелпери (конфіг, мова, токени)
 ├─ data/app-config.json # Основний конфіг
 ├─ design/              # JSON токени + згенеровані CSS/типи
 ├─ assets/scss          # Базові стилі, міксіни, брейкпоінти
 ├─ utils/               # Дати, sanitizeHtml, логування
 └─ main.ts              # Точка входу, DI для конфігів
```

## 3. Основні модулі та взаємодія

- **`createAppConfig`** (DI singleton) читає JSON, готує часові хелпери, кешує DOM-ресурси, оновлює список днів при зміні конфігу або поточної дати.
- **`CalendarContent`** отримує конфіг через composable, рендерить місяці/дні, керує скролом, відслідковує поточний місяць, слухає resize/RAF.
- **`TaskCard`** відображає задачу з таймером, статусами (active/finished/disabled) та обробляє клік кнопки.
- **`CalendarDays`** малює сітку кнопок днів (з плейсхолдерами для вирівнювання по тижнях) і піднімає події `day-click`.
- **`CalendarBanner`** відповідає за верхній банер із декоративними зображеннями та alt-текстами.
- **`TermsModal`** — модальне вікно з умовами використання, керується через `v-model`, використовує `<teleport>` для правильного позиціонування та `<transition>` для плавної анімації.

## 4. Швидкий старт

1. **Вимоги**: Node.js 20.19 або 22.12+ (див. `package.json -> engines`).
2. **Установка**:
   ```bash
   npm install
   ```
3. **Режим розробки**:
   ```bash
   npm run dev
   ```
   Скрипт попередньо згенерує дизайн-токени (`predev`) і запустить Vite.
4. **Перевірка конфігурації**:
   ```bash
   npm run validate-config
   ```
5. **Лінтери та форматування**:
   ```bash
   npm run check        # eslint + comment-policy
   npm run lint:styles  # stylelint
   npm run format       # prettier
   ```
6. **Сборка для продакшену**:
   ```bash
   npm run build
   ```
   Виконує `vue-tsc`, `vite build` і попередню оптимізацію зображень (`prebuild`).
7. **Попередній перегляд** зібраної версії:
   ```bash
   npm run preview
   ```

## 5. Подальша документація

### Для бізнес-користувачів та контент-менеджерів:

- [`docs/QUICK_SETUP_GUIDE.md`](docs/QUICK_SETUP_GUIDE.md) — **ПОЧНІТЬ ЗВІДСИ!** Швидке налаштування календаря за 5 хвилин, валідація, чек-листи, типові конфігурації.
- [`docs/CONFIG_GUIDE.md`](docs/CONFIG_GUIDE.md) — повний опис `app-config.json`, правила для дат, задач, локалізації та `config.ui` секцій.
- [`docs/TROUBLESHOOTING.md`](docs/TROUBLESHOOTING.md) — поширені проблеми та їх вирішення.

### Для розробників:

- [`docs/COMPONENTS_API.md`](docs/COMPONENTS_API.md) — API-компонент, події та стани, включаючи TermsModal.
- [`docs/DEVELOPER_GUIDE.md`](docs/DEVELOPER_GUIDE.md) — внутрішні компосабли, робота з датами, продуктивність, розширення.
- [`docs/BUILD_SCRIPTS.md`](docs/BUILD_SCRIPTS.md) — npm-скрипти, утиліти з `scripts/`, політика щодо коментарів.
- [`docs/DEPLOYMENT.md`](docs/DEPLOYMENT.md) — вимоги до оточення, збірка, налаштування iframe, тестові параметри.

### Для дизайнерів:

- [`docs/DESIGN_TOKENS.md`](docs/DESIGN_TOKENS.md) — тема alpa-dark, кольори, типографіка, брейкпоінти, робота з токенами.

### Для всіх:

- [`CHANGELOG.md`](CHANGELOG.md) — історія змін проекту.

**Рекомендований порядок читання:**

1. **Бізнес-користувачі:** QUICK_SETUP_GUIDE.md → CONFIG_GUIDE.md → TROUBLESHOOTING.md
2. **Розробники:** DEVELOPER_GUIDE.md → COMPONENTS_API.md → BUILD_SCRIPTS.md
3. **Дизайнери:** DESIGN_TOKENS.md → CONFIG_GUIDE.md
